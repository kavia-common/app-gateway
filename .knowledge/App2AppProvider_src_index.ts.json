{"is_source_file": true, "format": "TypeScript", "description": "This file defines the main class `App2AppProvider` that handles registration, invocation, and response/error forwarding between providers and consumers in an App2App plugin architecture. It manages JSON-RPC communication, correlates requests, and exposes an API for handling provider interactions.", "external_files": ["./types", "./providerRegistry", "./correlationStore", "./appGatewayClient"], "external_methods": ["jsonRpcError", "isNonEmptyString", "validateContext"], "published": ["App2AppProvider"], "classes": [{"name": "App2AppProvider", "description": "Main class handling registration, invocation, and response/error processing for app providers."}], "methods": [{"name": "registerProvider", "description": "Registers or unregisters a provider based on capability and context."}, {"name": "invokeProvider", "description": "Creates a correlation for a provider invocation and returns a correlation ID."}, {"name": "handleProviderResponse", "description": "Forwards successful provider responses back to the original consumer, based on correlation ID."}, {"name": "handleProviderError", "description": "Forwards error responses from the provider back to the consumer, using the correlation ID."}, {"name": "onConnectionDetached", "description": "Cleans up state related to a disconnecting connection."}, {"name": "function isNonEmptyString(v: unknown): v is string { isNonEmptyString", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "function jsonRpcError(code: number, message: string): Error { jsonRpcError", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "function validateContext(context?: RequestContext): asserts context is RequestContext { validateContext", "scope": "", "scopeKind": "", "description": "unavailable"}], "calls": ["this.gateway.respond"], "search-terms": ["App2AppProvider", "registerProvider", "invokeProvider", "handleProviderResponse", "handleProviderError", "CorrelationStore", "ProviderRegistry", "JSON-RPC", "provider", "registration", "response handling"], "state": 2, "file_id": 37, "knowledge_revision": 83, "git_revision": "084cc88e45a7d0154f69932fcd994e4e1f9262bd", "ctags": [{"_type": "tag", "name": "App2AppProvider", "path": "/home/kavia/workspace/code-generation/app-gateway/App2AppProvider/src/index.ts", "pattern": "/^export class App2AppProvider {$/", "language": "TypeScript", "kind": "class"}, {"_type": "tag", "name": "appId", "path": "/home/kavia/workspace/code-generation/app-gateway/App2AppProvider/src/index.ts", "pattern": "/^      appId: params.context.appId,$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "capability", "path": "/home/kavia/workspace/code-generation/app-gateway/App2AppProvider/src/index.ts", "pattern": "/^      capability: params.capability,$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "capability", "path": "/home/kavia/workspace/code-generation/app-gateway/App2AppProvider/src/index.ts", "pattern": "/^    const { context, register, capability } = params;$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "connectionId", "path": "/home/kavia/workspace/code-generation/app-gateway/App2AppProvider/src/index.ts", "pattern": "/^      connectionId: params.context.connectionId,$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "consumerCtx", "path": "/home/kavia/workspace/code-generation/app-gateway/App2AppProvider/src/index.ts", "pattern": "/^    const consumerCtx: ConsumerContext = {$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "context", "path": "/home/kavia/workspace/code-generation/app-gateway/App2AppProvider/src/index.ts", "pattern": "/^    const { context, register, capability } = params;$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "correlationId", "path": "/home/kavia/workspace/code-generation/app-gateway/App2AppProvider/src/index.ts", "pattern": "/^    const correlationId = this.correlations.create(consumerCtx);$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "createdAt", "path": "/home/kavia/workspace/code-generation/app-gateway/App2AppProvider/src/index.ts", "pattern": "/^      createdAt: Date.now()$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "ctx", "path": "/home/kavia/workspace/code-generation/app-gateway/App2AppProvider/src/index.ts", "pattern": "/^    const ctx = this.correlations.findAndErase(params.payload.correlationId);$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "err", "path": "/home/kavia/workspace/code-generation/app-gateway/App2AppProvider/src/index.ts", "pattern": "/^  const err = new Error(message);$/", "language": "TypeScript", "kind": "constant", "scope": "jsonRpcError", "scopeKind": "function"}, {"_type": "tag", "name": "isNonEmptyString", "path": "/home/kavia/workspace/code-generation/app-gateway/App2AppProvider/src/index.ts", "pattern": "/^function isNonEmptyString(v: unknown): v is string {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "jsonRpcError", "path": "/home/kavia/workspace/code-generation/app-gateway/App2AppProvider/src/index.ts", "pattern": "/^function jsonRpcError(code: number, message: string): Error {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "provider", "path": "/home/kavia/workspace/code-generation/app-gateway/App2AppProvider/src/index.ts", "pattern": "/^    const provider = this.providers.find(params.capability);$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "providers", "path": "/home/kavia/workspace/code-generation/app-gateway/App2AppProvider/src/index.ts", "pattern": "/^  private readonly providers: ProviderRegistry = new ProviderRegistry();$/", "language": "TypeScript", "kind": "property", "scope": "App2AppProvider", "scopeKind": "class"}, {"_type": "tag", "name": "register", "path": "/home/kavia/workspace/code-generation/app-gateway/App2AppProvider/src/index.ts", "pattern": "/^    const { context, register, capability } = params;$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "validateContext", "path": "/home/kavia/workspace/code-generation/app-gateway/App2AppProvider/src/index.ts", "pattern": "/^function validateContext(context?: RequestContext): asserts context is RequestContext {$/", "language": "TypeScript", "kind": "function"}], "hash": "17b2936c393a97b2a2a93126da5b7896", "format-version": 4, "code-base-name": "app-gateway", "filename": "App2AppProvider/src/index.ts", "fields": [{"name": "private readonly providers: ProviderRegistry = new ProviderRegistry();", "scope": "App2AppProvider", "scopeKind": "class", "description": "unavailable"}], "revision_history": [{"83": "084cc88e45a7d0154f69932fcd994e4e1f9262bd"}]}