{"is_source_file": true, "format": "C++ header file", "description": "This file declares the PermissionService class within the WPEFramework::Plugin namespace. The class manages permission checks including capability and role evaluation, listing permissions, and managing dynamic granted IDs based on registry mappings. It provides interfaces for checking individual and multiple capabilities, listing current permissions, and updating or retrieving the granted set.", "external_files": ["Module.h", "Registry.h"], "external_methods": [], "published": ["PermissionService"], "classes": [{"name": "PermissionService", "description": "A class responsible for evaluating permissions based on capabilities, roles, and granted IDs, interfacing with a registry and managing internal permission states."}], "methods": [{"name": "PermissionService", "description": "Constructor initializing the PermissionService with a registry reference and cache TTL."}, {"name": "CheckCapability", "description": "Evaluate whether a capability with a specific role is permitted."}, {"name": "CheckAll", "description": "Evaluate multiple capability+role pairs and return their permission status."}, {"name": "ListCapabilities", "description": "List all current capabilities derived from the granted IDs."}, {"name": "ListFireboltPermissions", "description": "List current raw permission IDs from the granted set."}, {"name": "SetGrantedIds", "description": "Replace the current set of granted IDs, typically sourced from configuration."}, {"name": "GetGrantedIds", "description": "Retrieve the current granted set as a read-only snapshot."}], "calls": ["ToLower"], "search-terms": ["PermissionService", "permission checks", "Registry", "dynamic grants", "capability", "role", "list permissions", "granted set"], "state": 2, "file_id": 46, "knowledge_revision": 106, "git_revision": "5f72cb2651e336c751a5ac763e100158c790b1a1", "revision_history": [{"95": ""}, {"106": "5f72cb2651e336c751a5ac763e100158c790b1a1"}], "ctags": [{"_type": "tag", "name": "PermissionService", "path": "/home/kavia/workspace/code-generation/app-gateway/Badger/include/Badger/PermissionService.h", "pattern": "/^class PermissionService {$/", "language": "C++", "kind": "class", "scope": "WPEFramework::Plugin", "scopeKind": "namespace"}, {"_type": "tag", "name": "Plugin", "path": "/home/kavia/workspace/code-generation/app-gateway/Badger/include/Badger/PermissionService.h", "pattern": "/^namespace Plugin {$/", "language": "C++", "kind": "namespace", "scope": "WPEFramework", "scopeKind": "namespace"}, {"_type": "tag", "name": "WPEFramework", "path": "/home/kavia/workspace/code-generation/app-gateway/Badger/include/Badger/PermissionService.h", "pattern": "/^namespace WPEFramework {$/", "language": "C++", "kind": "namespace"}, {"_type": "tag", "name": "_granted", "path": "/home/kavia/workspace/code-generation/app-gateway/Badger/include/Badger/PermissionService.h", "pattern": "/^    std::unordered_set<string> _granted; \\/\\/ dynamic grants$/", "language": "C++", "typeref": "typename:std::unordered_set<string>", "kind": "member", "scope": "WPEFramework::Plugin::PermissionService", "scopeKind": "class"}, {"_type": "tag", "name": "_lock", "path": "/home/kavia/workspace/code-generation/app-gateway/Badger/include/Badger/PermissionService.h", "pattern": "/^    mutable std::mutex _lock;$/", "language": "C++", "typeref": "typename:std::mutex", "kind": "member", "scope": "WPEFramework::Plugin::PermissionService", "scopeKind": "class"}, {"_type": "tag", "name": "_reg", "path": "/home/kavia/workspace/code-generation/app-gateway/Badger/include/Badger/PermissionService.h", "pattern": "/^    const Registry& _reg;$/", "language": "C++", "typeref": "typename:const Registry &", "kind": "member", "scope": "WPEFramework::Plugin::PermissionService", "scopeKind": "class"}, {"_type": "tag", "name": "_ttl", "path": "/home/kavia/workspace/code-generation/app-gateway/Badger/include/Badger/PermissionService.h", "pattern": "/^    uint32_t _ttl;$/", "language": "C++", "typeref": "typename:uint32_t", "kind": "member", "scope": "WPEFramework::Plugin::PermissionService", "scopeKind": "class"}], "hash": "b0e4055b4f3db4f6f89f4fca9bd7719f", "format-version": 4, "code-base-name": "app-gateway", "filename": "Badger/include/Badger/PermissionService.h", "fields": [{"name": "std::unordered_set<string> _granted", "scope": "WPEFramework::Plugin::PermissionService", "scopeKind": "class", "description": "unavailable"}, {"name": "std::mutex _lock", "scope": "WPEFramework::Plugin::PermissionService", "scopeKind": "class", "description": "unavailable"}, {"name": "const Registry & _reg", "scope": "WPEFramework::Plugin::PermissionService", "scopeKind": "class", "description": "unavailable"}, {"name": "uint32_t _ttl", "scope": "WPEFramework::Plugin::PermissionService", "scopeKind": "class", "description": "unavailable"}]}