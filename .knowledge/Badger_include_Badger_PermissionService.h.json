{"is_source_file": true, "format": "C++ header file", "description": "This file declares the PermissionService class, which manages permission checks using a registry and dynamic grant sets. It provides methods to evaluate capabilities, list permissions, and update granted IDs.", "external_files": ["Module.h", "Registry.h"], "external_methods": [], "published": ["PermissionService"], "classes": [{"name": "PermissionService", "description": "Handles permission checks and management, integrating with a registry and managing dynamic granted IDs."}], "methods": [{"name": "PermissionService", "description": "Constructor initializing the service with a registry reference and cache TTL."}, {"name": "CheckCapability", "description": "Checks if a specific capability and role are permitted."}, {"name": "CheckAll", "description": "Evaluates multiple capability-role pairs and returns their permission statuses."}, {"name": "ListCapabilities", "description": "Returns currently available capabilities derived from granted IDs."}, {"name": "ListFireboltPermissions", "description": "Lists current raw permissions used by Thor/Badger."}, {"name": "SetGrantedIds", "description": "Replaces the current set of granted IDs (used for injection/configuration)."}, {"name": "GetGrantedIds", "description": "Returns a read-only snapshot of the current granted IDs."}], "calls": ["ToLower"], "search-terms": ["PermissionService", "CheckCapability", "ListFireboltPermissions", "Registry", "granted set", "dynamic grants"], "state": 2, "file_id": 46, "knowledge_revision": 95, "git_revision": "", "ctags": [{"_type": "tag", "name": "PermissionService", "path": "/home/kavia/workspace/code-generation/app-gateway/Badger/include/Badger/PermissionService.h", "pattern": "/^class PermissionService {$/", "language": "C++", "kind": "class", "scope": "WPEFramework::Plugin", "scopeKind": "namespace"}, {"_type": "tag", "name": "Plugin", "path": "/home/kavia/workspace/code-generation/app-gateway/Badger/include/Badger/PermissionService.h", "pattern": "/^namespace Plugin {$/", "language": "C++", "kind": "namespace", "scope": "WPEFramework", "scopeKind": "namespace"}, {"_type": "tag", "name": "WPEFramework", "path": "/home/kavia/workspace/code-generation/app-gateway/Badger/include/Badger/PermissionService.h", "pattern": "/^namespace WPEFramework {$/", "language": "C++", "kind": "namespace"}, {"_type": "tag", "name": "_granted", "path": "/home/kavia/workspace/code-generation/app-gateway/Badger/include/Badger/PermissionService.h", "pattern": "/^    std::unordered_set<string> _granted; \\/\\/ dynamic grants$/", "language": "C++", "typeref": "typename:std::unordered_set<string>", "kind": "member", "scope": "WPEFramework::Plugin::PermissionService", "scopeKind": "class"}, {"_type": "tag", "name": "_lock", "path": "/home/kavia/workspace/code-generation/app-gateway/Badger/include/Badger/PermissionService.h", "pattern": "/^    mutable std::mutex _lock;$/", "language": "C++", "typeref": "typename:std::mutex", "kind": "member", "scope": "WPEFramework::Plugin::PermissionService", "scopeKind": "class"}, {"_type": "tag", "name": "_reg", "path": "/home/kavia/workspace/code-generation/app-gateway/Badger/include/Badger/PermissionService.h", "pattern": "/^    const Registry& _reg;$/", "language": "C++", "typeref": "typename:const Registry &", "kind": "member", "scope": "WPEFramework::Plugin::PermissionService", "scopeKind": "class"}, {"_type": "tag", "name": "_ttl", "path": "/home/kavia/workspace/code-generation/app-gateway/Badger/include/Badger/PermissionService.h", "pattern": "/^    uint32_t _ttl;$/", "language": "C++", "typeref": "typename:uint32_t", "kind": "member", "scope": "WPEFramework::Plugin::PermissionService", "scopeKind": "class"}], "hash": "c671a4477c8d7d166bcadc0d22d6950d", "format-version": 4, "code-base-name": "app-gateway", "filename": "Badger/include/Badger/PermissionService.h", "fields": [{"name": "std::unordered_set<string> _granted", "scope": "WPEFramework::Plugin::PermissionService", "scopeKind": "class", "description": "unavailable"}, {"name": "std::mutex _lock", "scope": "WPEFramework::Plugin::PermissionService", "scopeKind": "class", "description": "unavailable"}, {"name": "const Registry & _reg", "scope": "WPEFramework::Plugin::PermissionService", "scopeKind": "class", "description": "unavailable"}, {"name": "uint32_t _ttl", "scope": "WPEFramework::Plugin::PermissionService", "scopeKind": "class", "description": "unavailable"}], "revision_history": [{"95": ""}]}